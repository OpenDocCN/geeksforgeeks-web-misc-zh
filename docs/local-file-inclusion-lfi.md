# 本地文件包含(LFI)

> 原文:[https://www.geeksforgeeks.org/local-file-inclusion-lfi/](https://www.geeksforgeeks.org/local-file-inclusion-lfi/)

文件包含漏洞是一种常见于基于 PHP 的网站的漏洞，用于影响网络应用程序。当应用程序试图从特定服务器获取某些信息时，通常会出现此问题，因为获取特定文件位置的输入不被视为可信来源。

它通常指的是包含攻击，攻击者可以提供有效的输入来从 web 服务器获得响应。作为回应，攻击者将能够判断他提供的输入是否有效。如果它是有效的，那么无论攻击者想要查看哪个文件，他们都可以轻松地访问它。

以下示例说明了 LFI 漏洞的工作过程:

```html
<?php

// The Page we wish to display
$file = $_GET['page']; 
?>
```

**本地文件包含工作:**我们通过下面的例子来了解一下本地文件包含的工作原理:

在上例中 **`"$file = $_GET['page'];"`** **$file** 只是一个文件/代码，用于指示 PHP 代码将返回一个‘文件’作为响应。 **`$_GET`** 是将从网络服务器获得特定文件或网页的指令集之一，即它将请求文件。 **`['page']`** 是一个参数，它将定义作为响应将显示什么类型的页面。

**当地的 LFI 在哪里发现的？**
基本上就是这个位置

> http://易损 _host/preview.php？file=abc.html

这是攻击者可以对 web 应用程序执行 LFI 攻击的地方。该脚本可以包含在 URL 中，该 URL 包含将对其执行攻击的各种参数。服务器上可能包含任意文件。受攻击者影响的网址如下所示:

> http://易损 _host/preview.php？文档=../../../../etc/passwd

**识别网络应用程序中的漏洞:**识别网络应用程序中的 LFI 漏洞很容易，因为它将包含来自网络服务器的文件并将其返回给攻击者。
**比如** "/fi/？page=include.php "如果 web 应用程序中存在上述示例或与该示例相关的内容，那么在这样的应用程序中可能会出现 LFI。

圣灵降临者会试图从这种错误配置中获益，即他可以通过操纵参数来利用此漏洞。
**例如** "/fi/？page=include.php "只有当 index.php "文件存在于同一目录中时，此操作才会成功执行。如果没有，我们必须补充”../"在" index.php "前面。

想象一下**“index . PHP”**位于 **`"/var/www/html"`** 文件夹，**“include . PHP”**位于 **`"/var/www/dvwa/vulnerabilities/lfi/"`** 文件夹，你只能看到这个文件夹位置的文件的回复。现在要执行位于另一个目录中的文件，我们必须在 URL 中更改我们的目录。**例如** **`"/fi/?page=../../../index.php"`** 。

**LFI 进攻有三种可能的场景:**

*   包括要由语言解释器解析的文件
*   包括打印到页面的文件
*   包括作为下载的文件

**本地文件包含漏洞的影响:**攻击者将能够通过利用 LFI 漏洞访问以下内容:

*   存储在网络服务器中的文件的信息公开
*   密码/数据库访问
*   日志文件
*   完全系统妥协

**修复文件包含(LFI)漏洞:**

*   人们不应该允许可以直接修改的文件路径，要么是硬编码的，要么是通过硬编码路径列表选择的。
*   必须确保所需的应该具有动态路径连接，即必须包含(a-z) (0-9)而不是(/、/%等)
*   应该对 API 进行特定的限制，以便只有包含在其下的目录才能工作，这样目录遍历攻击就不会在这种情况下发生