# 网络应用文件上传漏洞

> 原文:[https://www . geesforgeks . org/file-upload-web 应用程序漏洞/](https://www.geeksforgeeks.org/file-upload-vulnerability-of-web-applications/)

在这篇文章中，我们将详细了解更多的攻击媒介，在这个拥有大量网络和移动应用的世界中，学习这些攻击媒介非常重要。

#### 文件上传漏洞:

几乎每个网络应用程序都有上传文件的功能。该文件可以是文本、视频、图像等形式。然而，许多网络应用程序在上传文件时没有适当的安全检查，这导致了一个称为文件上传漏洞的漏洞。这个简单的漏洞导致服务器端脚本、任意代码执行、跨站点脚本、CSRF 攻击。

即使某些应用程序对上传文件进行了适当检查，但这些安全检查仍有绕过方法来利用此漏洞，这些绕过方法如下–

**1。区分大小写的扩展绕过:** Web/Mobile 应用开发者可能会添加某个扩展的黑名单，根据开发者判断是有害的。但是有时开发人员忘记了他们扩展名安全检查是否区分大小写，任何人都可以通过将文件的扩展名作为小写和大写字符的组合来绕过安全检查，从而绕过安全检查。作为一个开发人员，检查扩展验证总是要考虑文件扩展名的大小写敏感性，这是一个很好的做法。示例:。，PDf。XmL，。嘘，php。

**2。图像内容验证旁路:**出于安全考虑，开发人员总是检查图像的内容，以匹配有效的文件类型之一。在 PHP 中有五个函数可以验证文件，其中一个函数是 get getimagesize()这个函数基本上是读取文件并返回大小，在文件无效的情况下返回错误消息。有些技术可以绕过这种保护。考虑以下上传文件的代码。

## 服务器端编程语言（Professional Hypertext Preprocessor 的缩写）

```html
<?php

if(isset($_FILES['image'])) {
    $filename = $_FILES['image']['name'];

    $tmp = $_FILES['image']['tmp_name'];

    if(!getimagesize($_FILES['image']['tmp_name'])) {
        echo "Invalid Image File";
        exit(0);
    }

    move_uploaded_file($tmp,"images/".$filename);

    echo "SUCCESS";
    exit(0);
}

?>
```

攻击者可以通过在 JPG 文件的注释部分嵌入 PHP 代码，然后用。php 扩展这可以很容易地绕过上面代码中提到的检查。还有更多技术可以绕过文件验证，因为开发人员在实现文件上传功能时总是会处理所有这些绕过。

#### 使用恶意图像文件的像素泛滥:

这是文件上传漏洞下的子攻击，该攻击主要利用图像解析的方法。在执行此攻击期间，恶意用户获取具有原始维度的有效 JPG 或 JPEG 文件，然后攻击者通过使用一些自动化工具将图像的维度更改为非常大的规模，如 1000000 ×1000000，上传如此大的文件图像解析器为其分配非常大的内存，导致服务器崩溃或内存不足的情况。

#### PNG 文件的恶意 zTXT 字段:

PNG 文件格式包含一个名为 zTXT 的部分，它允许将 zlib 压缩数据添加到 PNG 文件中。这里的技术是创建大量重复的数据，例如一系列零，加权超过 70MB，然后通过 zlib 进行 DEFLATE 压缩，得到几千字节的压缩数据。然后将其添加到任何常规 PNG 文件的 zTXT 部分。发送这种类型的重复请求会导致类似的内存耗尽，就像我们在前面两个例子中看到的那样。这个问题也影响了回形针宝石。

#### 恶意 GIF 文件–帧泛滥:

这种技术类似于以前的技术，一个恶意的 GIF 被用来分配大量的内存，最终使用大量的服务器内存。GIF 文件包含各种图像帧形式的一组动画。我们没有翻转像素，而是添加了大量的 GIF 帧，比如 45，000-90，000 帧。解析每一帧时，都会分配内存，最终会阻塞服务器。

#### 如何避免文件上传漏洞:

*   始终检查文件的扩展名是否区分大小写。
*   在上传到服务器之前过滤文件内容。
*   不要授予上传文件的可执行权限。
*   始终将上传的文件存储在非公共目录中。