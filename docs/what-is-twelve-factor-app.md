# 什么是十二因素 App？

> 原文:[https://www.geeksforgeeks.org/what-is-twelve-factor-app/](https://www.geeksforgeeks.org/what-is-twelve-factor-app/)

十二因素应用程序是构建网络应用程序的 12 个原则或最佳实践的集合，现在这些应用程序通常被称为软件即服务(SAAS)应用程序。该书由 Heroku 的联合创始人亚当·威金斯先生于 2011 年出版。这些原则是在 Heroku(一个平台即服务)工作的人从部署在其上的各种软件即服务应用程序中获得的所有经验和观察的结果。

这些原则帮助我们创建应用程序，这些应用程序使用**声明性**编程来实现设置自动化，这反过来减少了新开发人员加入时的开发时间和项目成本，不依赖于任何特定的操作系统，并且易于**移植**，非常适合在云上**部署**，并且允许**连续部署**，并且易于横向扩展，而不需要对代码库进行许多更改。这些因素如下:

**1。代码库**

*版本控制中跟踪的每个应用程序都有一个代码库，部署了许多。*让我们打破它的官方说法，试着理解其中的两个主要术语。用简单的术语来说，代码库是所有人工编写的源代码，不包括工具生成的类或对象文件。部署是指该特定应用程序的单个运行实例。每个应用程序必须只有一个代码库。每个这样的代码库必须在版本控制系统中进行管理。一些流行的 VCS(版本控制系统)包括 git，svn 和 mercurial。如果存在多个代码库，那么它就不是一个应用程序，而是一个分布式系统。该系统的每个组件都将被称为一个应用程序，它将遵循 12 因素应用程序的原则。

**2。依赖关系**

*明确声明和隔离依赖关系。*在我们的编程生涯中，我们都必须至少观察过一次这种情况:我们出于某种目的下载了一个 python 库，然后发现我们下载了错误版本的库，或者在我们的系统中安装了错误版本的 python。这通常是因为管理依赖关系的任务交给了开发人员。因此，这个因素表明我们必须总是在清单文件中声明依赖关系，清单文件包含依赖关系的元数据，如名称、版本。它提高了开发速度，因为现在开发人员不再需要管理正确版本的库。不再需要显式下载所需的 JARs。

**3。配置**

*在环境中存储配置。*源代码和配置必须完全分离。我们必须将所有配置(如数据库凭据、路径、URI)存储在环境变量中。在行业的一般实践中，应用程序的配置因环境而异，如开发、测试、生产等。此外，任何配置都不应以纯文本形式存储在 git 中。有一个非常简单的方法，你可以检查你当前的应用程序是否遵循这个*配置*原则，问你自己是否可以让你的应用程序立即开源，而不做任何更改，也不损害你的任何凭证。

**4。支持服务**

*将后备服务视为附属资源。*如果我们用非常简单的术语来说，那么您的应用程序通过网络消费的任何服务都被称为后备服务。您的应用程序必须将这些服务视为它在网络上消耗的资源。它给我们的优势是，我们的服务变得容易互换，并为我们的应用程序提供了极大的可移植性。
一个简单的例子是，假设您的应用程序当前使用本地 PostgreSQL 数据库进行操作，然后通过更改 URL 和数据库凭据，将其替换为贵公司服务器上托管的数据库。

**5。构建、发布和运行**

*严格分开建造和运行阶段。*您的应用程序的部署必须正确地分成三个不重叠、不相关的阶段，即构建、发布和运行。构建阶段构成了代码的编译，最终生成像 JAr 或 WAR 文件这样的工件。第二阶段，发布，获取在前一阶段结束时生成的工件文件，并将特定环境的配置添加到其中。最后一个阶段包括应用程序实例的运行。

**6。流程**

*作为一个或多个无状态进程执行应用程序。*如果一个应用程序的实例可以在任何时候被创建和销毁，而不会对我们的应用程序的整体功能产生任何影响，那么这个应用程序就是遵循这个原则的。为了实现这一原则，我们的应用程序必须将它生成的任何类型的数据存储在任何持久的(有状态的)数据存储中。但这并不意味着我们不能使用应用程序进程的内存。我们可以用它来储存作为临时储存。简单来说，必须避免使用粘性会话。简单来说，粘性会话是指在进程的本地内存中捕获登录用户的会话数据，然后将该特定用户的每个后续请求定向到同一个进程。粘性会话的问题在于，它会导致应用程序实例之间的负载平衡不均衡。

**7。端口绑定**

*通过端口绑定导出服务。*任何遵循此原则的应用程序都是完全独立的。它将 HTTP 作为服务导出，不需要像 tomcat 这样的任何服务器来监听请求。它将自己绑定到某个特定的端口，并监听到达该端口的所有请求。在设计运行在特定端口上的应用程序或微服务时，您一定也观察到了这一点，并使用 postman 在该特定端口上命中请求以获得响应。我们的服务将监听哪个端口的信息也存储在配置文件本身中。

**8。并发**

*通过流程模型横向扩展。*遵循这一原则的应用程序必须分成较小的不同流程，而不是单一的大型应用程序。每一个这样的过程都必须能够独立地、随时地启动、终止和自我复制。这个原则允许我们非常容易地扩展我们的应用程序。横向扩展指的是水平扩展，即我们运行流程的多个实例。由于独立的水平可扩展进程的存在，它以一种非常简单的方式为我们的应用程序增加了并发性。

**9。一次性**

*通过快速启动和优雅关闭，最大限度地提高鲁棒性。*应用程序的健壮性是指在不影响整个应用程序功能的情况下，其进程的正常启动和终止。例如，我们的应用程序的一个过程是将新加入公司的员工的详细信息存储到数据库中。但在这样做的同时，中间会发生意外错误，导致进程意外终止。然而，我们的应用程序或数据库的状态不能受到它的影响，并且这个过程必须是无故障的。此外，无论何时需要，都必须快速启动。

**10。开发/生产平价**

*保持开发、分期和生产尽可能相似。*简单来说就是开发和生产环境必须尽可能相似。使用的流程、技术和基础设施必须相同。这将在某种程度上帮助你，随着时间的推移可能发生的任何错误都将发生在开发阶段本身，而不是令人惊讶地发生在生产中。这有助于我们应用程序的持续部署，也减少了开发时间和工作量。

**11 时。日志**

*将日志视为事件流。*日志对于了解应用程序的内部工作非常重要，它可以是不同级别的，通常存储在存储中名为“logFile”的文件中。理想情况下，我们的十二因素应用程序不必担心日志的存储。每当请求进入系统时，都会生成相应的日志，并将它们作为一系列事件来处理，以便在出现问题时进行调试。

**12 时。管理流程**

*一次性运行管理/管理任务。*大多数应用程序需要在应用程序的实际流程开始之前执行一些一次性任务。这些任务并不经常需要，因此，我们通常会为其创建一个脚本，并从其他环境中运行。另一方面，十二因素方法论认为，这样的脚本必须成为版本控制系统中管理的代码库的一部分。这些任务也应该遵循十二要素原则。